<!--views/pages/admin/playground.ejs-->
<%- include("../../layout/base", {
  title: "API Playground",
  body: `
<hgroup>
  <h1>API Playground</h1>
  <p>Swagger-like API explorer for backend testing</p>
</hgroup>

<!-- AUTH SECTION -->
<article class="side-by-side">
  <!-- Generate JWT -->
  <div>
    <h3>ğŸ” Generate JWT</h3>

    <input
      id="pg-email"
      class="compact-input"
      type="email"
      placeholder="Email"
    />

    <div class="password-wrapper">
      <input
        id="pg-password"
        type="password"
        class="compact-input"
        placeholder="Password"
      />
      <span
        class="toggle-password"
        onclick="togglePlaygroundPassword()"
        title="Show / Hide password"
      >ğŸ‘</span>
    </div>

    <button id="generate-token">Generate Token</button>
    <p id="pg-auth-message" class="muted"></p>
  </div>

  <!-- Authorization -->
  <div>
    <h3>Authorization</h3>

    <select id="authType" class="compact-input">
      <option value="none">No Auth</option>
      <option value="bearer" selected>Bearer</option>
    </select>

    <div id="bearer-panel">
      <input
        id="token"
        class="compact-input"
        placeholder="Bearer Token"
      />
    </div>
  </div>
</article>

<!-- INFO SECTION -->
<article class="side-by-side">
  <div>
    <h3>ğŸ“˜ Data Ownership Rules</h3>
    <ul class="muted">
      <li>Anyone can read all tasks</li>
      <li>Creating assigns ownership to your JWT</li>
      <li>Only owners can update/delete</li>
      <li>Enforced at API + RLS level</li>
    </ul>
  </div>

  <div>
    <h3>Endpoints</h3>
    <ul id="endpoint-list" class="endpoint-list"></ul>
  </div>
</article>

<!-- REQUEST / RESPONSE -->
<section class="grid">
  <article>
    <h3>Request</h3>

    <input id="method" readonly placeholder="HTTP Method" />
    <input id="endpoint" placeholder="Endpoint URL" />

    <!-- Tabs -->
    <nav>
      <ul>
        <li><a href="#" data-tab="params">Params</a></li>
        <li><a href="#" data-tab="headers">Headers</a></li>
        <li><a href="#" data-tab="body">Body</a></li>
      </ul>
    </nav>

    <!-- Params -->
    <section data-panel="params">
      <h5>Path Params</h5>
      <div id="path-params"></div>

      <h5>Query Params</h5>
      <div id="query-params"></div>
    </section>

    <!-- Headers -->
    <section data-panel="headers" hidden>
      <p><strong>Authorization</strong> auto-injected</p>
      <p><code>Content-Type</code> automatic</p>
    </section>

    <!-- Body -->
    <section data-panel="body" hidden>
      <select id="bodyType">
        <option value="none">No Body</option>
        <option value="json">JSON</option>
      </select>

      <textarea id="body" rows="8" placeholder="Request JSON body"></textarea>
      <button id="beautify">Beautify JSON</button>
    </section>

    <footer>
      <button id="send">Send Request</button>
      <button class="outline" id="copyCurl">Copy as cURL</button>
    </footer>
  </article>

  <!-- Response -->
  <article id="response-panel">
    <h3>Response</h3>

    <ul>
      <li>Status: <strong id="status">â€”</strong></li>
      <li>Time: <strong id="time">â€”</strong> ms</li>
      <li>Rate Limit: <strong id="rate">â€”</strong></li>
    </ul>

    <details open>
      <summary>Response Schema</summary>
      <pre id="schema"></pre>
    </details>

    <pre><code id="response">{}</code></pre>
  </article>
</section>

<script src="/js/playground.js"></script>
`
}) %>
