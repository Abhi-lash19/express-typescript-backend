<!--views/pages/admin/playground.ejs-->

<%- include("../../layout/base", {
  title: "API Playground",
  body: `
<hgroup>
  <h1>API Playground</h1>
  <p>Swagger-like API explorer for backend testing</p>
</hgroup>

<!-- Generate JWT  Authorization -->
<article class="side-by-side">
  <div>
    <h3>üîê Generate JWT</h3>
    <label>Email <input id="pg-email" class="compact-input" /></label>
    <label>Password <input id="pg-password" type="password" class="compact-input" /></label>
    <button id="generate-token">Generate Token</button>
    <p id="pg-auth-message" class="muted"></p>
  </div>

  <div>
    <h3>Authorization</h3>
    <label>Auth Type
      <select id="authType" class="compact-input">
        <option value="none">None</option>
        <option value="bearer" selected>Bearer</option>
      </select>
    </label>

    <div id="bearer-panel">
      <label>Bearer Token
        <input id="token" class="compact-input" />
      </label>
    </div>
  </div>
</article>

<!-- SIDE BY SIDE -->
<article class="side-by-side">
  <div>
    <h3>üìò Data Ownership Rules</h3>
    <ul class="muted">
      <li>Anyone can read all tasks</li>
      <li>Creating assigns ownership to your JWT</li>
      <li>Only owners can update/delete</li>
      <li>Enforced at API + RLS level</li>
    </ul>
  </div>

  <div>
    <h3>Endpoints</h3>
    <ul id="endpoint-list" class="endpoint-list"></ul>
  </div>
</article>

<section class="grid">
  <article>
    <h3>Request</h3>

    <label>Method
      <input id="method" readonly />
    </label>

    <label>Endpoint
      <!-- FIXED: editable -->
      <input id="endpoint" />
    </label>

    <!-- Tabs -->
    <nav>
      <ul>
        <li><a href="#" data-tab="params">Params</a></li>
        <li><a href="#" data-tab="headers">Headers</a></li>
        <li><a href="#" data-tab="body">Body</a></li>
      </ul>
    </nav>

    <!-- Params -->
    <section data-panel="params">
      <h5>Path Params</h5>
      <div id="path-params"></div>

      <h5>Query Params</h5>
      <div id="query-params"></div>
    </section>

    <!-- Headers -->
    <section data-panel="headers" hidden>
      <p><strong>Authorization</strong> auto-injected</p>
      <p><code>Content-Type</code> automatic</p>
    </section>

    <!-- Body -->
    <section data-panel="body" hidden>
      <label>Body Type
        <select id="bodyType">
          <option value="none">None</option>
          <option value="json">JSON</option>
        </select>
      </label>

      <label>Request Body
        <textarea id="body" rows="8"></textarea>
      </label>

      <button id="beautify">Beautify JSON</button>
    </section>

    <footer>
      <button id="send">Send Request</button>
      <button class="outline" id="copyCurl">Copy as cURL</button>
    </footer>
  </article>

  <!-- Response -->
  <article id="response-panel">
    <h3>Response</h3>

    <ul>
      <li>Status: <strong id="status">‚Äî</strong></li>
      <li>Time: <strong id="time">‚Äî</strong> ms</li>
      <li>Rate Limit: <strong id="rate">‚Äî</strong></li>
    </ul>

    <details open>
      <summary>Response Schema</summary>
      <pre id="schema"></pre>
    </details>

    <pre><code id="response">{}</code></pre>
  </article>
</section>

<script src="/js/playground.js"></script>
`
}) %>
