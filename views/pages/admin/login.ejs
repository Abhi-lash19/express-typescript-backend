<!--views/pages/admin/login.ejs-->

<%- include("../../layout/base", {
  title: "Login / Signup",
  body: `
    <hgroup>
      <h1>Create Account / Login</h1>
      <p>Demo authentication for testing write APIs</p>
    </hgroup>

    <article>
      <p class="muted">
        This is a demo system.
        Use any valid-looking email (e.g. <code>user@test.dev</code>).
        Please remember your email and password if you want to access the same data later.
      </p>

      <form id="signup-form">
        <label>
          Email
          <input
            type="email"
            id="email"
            placeholder="user@test.dev"
            required
          />
        </label>

        <label>
          Password
          <input
            type="password"
            id="password"
            placeholder="StrongPass@123"
            required
          />
        </label>

        <small class="muted">
          Password must be at least 10 characters and include
          an uppercase letter, number, and symbol.
        </small>

        <button type="submit">Create Account</button>
      </form>

      <p id="auth-message" class="muted"></p>
    </article>

    <script>
      document.getElementById("signup-form").addEventListener("submit", async (e) => {
        e.preventDefault();

        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;
        const msg = document.getElementById("auth-message");

        msg.textContent = "Creating account...";

        try {
          const res = await fetch("/auth/signup", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email, password }),
          });

          const data = await res.json();

          if (!res.ok) {
            msg.textContent = data?.error?.message || "Signup failed";
            return;
          }

          msg.textContent = "Account created successfully. You can now use the Playground.";
        } catch (err) {
          msg.textContent = "Network error. Please try again.";
        }
      });
    </script>
  `
}) %>
