############################################
# Server: http://localhost:3000
# Auth: Supabase JWT
############################################

@token = eyJhbGciOiJFUzI1NiIsImtpZCI6IjlmODFjNmE0LWNjYTMtNDM3Yy04ZjI3LWMxYWU2ZTBlMjAyMyIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL3B3bnR6dGRjcmRtdG90cWdjdnVlLnN1cGFiYXNlLmNvL2F1dGgvdjEiLCJzdWIiOiIwMjllNzBmMC1mMjg1LTQyNzUtODA2Mi00NjU3YzU0YzFiZWIiLCJhdWQiOiJhdXRoZW50aWNhdGVkIiwiZXhwIjoxNzY3NDMyNTg0LCJpYXQiOjE3Njc0Mjg5ODQsImVtYWlsIjoiYWJoaWxhc2hrdW1hcmdpcmk2M0BnbWFpbC5jb20iLCJwaG9uZSI6IiIsImFwcF9tZXRhZGF0YSI6eyJwcm92aWRlciI6ImVtYWlsIiwicHJvdmlkZXJzIjpbImVtYWlsIl19LCJ1c2VyX21ldGFkYXRhIjp7ImVtYWlsX3ZlcmlmaWVkIjp0cnVlfSwicm9sZSI6ImF1dGhlbnRpY2F0ZWQiLCJhYWwiOiJhYWwxIiwiYW1yIjpbeyJtZXRob2QiOiJwYXNzd29yZCIsInRpbWVzdGFtcCI6MTc2NzQyODk4NH1dLCJzZXNzaW9uX2lkIjoiNGU4ZmQyNWEtZjU4MS00ZDY1LWFjZGYtMDNlMTc0ZDMyZWU1IiwiaXNfYW5vbnltb3VzIjpmYWxzZX0.N6mC9NJ6JMa8LEGeYwmj0jwwOiteiDYKOM7wWwqxoFUpaI9yJYUZQ6GJDTHw98-UpPi_tNFLZzVJ_RjhbMAkOA


############################################
# 1. LIST TASKS (AUTHORIZED)
# Expected: 200 OK
############################################
### List tasks
GET http://localhost:3000/tasks
Authorization: Bearer {{token}}


############################################
# 2. SEARCH TASKS (USER-SCOPED)
# Expected: 200 OK
############################################
### Search tasks
GET http://localhost:3000/tasks?search=1
Authorization: Bearer {{token}}


############################################
# 3. LIST TASKS WITH PAGINATION
# Expected: 200 OK
############################################
### Paginated tasks
GET http://localhost:3000/tasks?page=1&limit=5
Authorization: Bearer {{token}}


############################################
# 4. LIST TASKS â€“ INVALID PAGINATION
# Reason: limit > max (100)
# Expected: 400 Bad Request
############################################
### Invalid pagination
GET http://localhost:3000/tasks?page=1&limit=500
Authorization: Bearer {{token}}


############################################
# 5. GET TASK BY ID (OWN TASK)
# Expected: 200 OK
############################################
### Get task by ID
GET http://localhost:3000/tasks/1
Authorization: Bearer {{token}}


############################################
# 6. GET TASK BY ID (NOT OWNED)
# Expected: 404 Not Found
############################################
### Cross-user access attempt
GET http://localhost:3000/tasks/9999
Authorization: Bearer {{token}}


############################################
# 7. GET TASK BY INVALID ID
# Reason: id must be numeric
# Expected: 400 Bad Request
############################################
### Invalid task ID
GET http://localhost:3000/tasks/abc
Authorization: Bearer {{token}}


############################################
# 8. CREATE TASK (VALID)
# Expected: 201 Created
############################################
### Create task
POST http://localhost:3000/tasks
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "My Supabase Task new",
  "completed": false
}


############################################
# 9. CREATE TASK (INVALID BODY)
# Reason: title empty
# Expected: 400 Bad Request
############################################
### Invalid create
POST http://localhost:3000/tasks
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "",
  "completed": false
}


############################################
# 10. UPDATE TASK (OWNED)
# Expected: 200 OK
############################################
### Update task
PUT http://localhost:3000/tasks/15
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Updated title",
  "completed": true
}


############################################
# 11. UPDATE TASK (NOT OWNED)
# Expected: 404 Not Found
############################################
### Cross-user update attempt
PUT http://localhost:3000/tasks/9999
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Hacked title",
  "completed": true
}


############################################
# 12. DELETE TASK (OWNED)
# Expected: 200 OK
############################################
### Delete task
DELETE http://localhost:3000/tasks/15
Authorization: Bearer {{token}}


############################################
# 13. DELETE TASK (NOT OWNED)
# Expected: 404 Not Found
############################################
### Cross-user delete attempt
DELETE http://localhost:3000/tasks/9999
Authorization: Bearer {{token}}


############################################
# 14. UNAUTHORIZED ACCESS
# Expected: 401 Unauthorized
############################################
### Missing token
GET http://localhost:3000/tasks


############################################
# 15. INVALID TOKEN
# Expected: 401 Unauthorized
############################################
### Invalid token
GET http://localhost:3000/tasks
Authorization: Bearer invalid.token.value


############################################
# 16. API V1 ROUTES (SAME AUTH BEHAVIOR)
# Expected: 200 OK
############################################
### List tasks via API v1
GET http://localhost:3000/api/v1/tasks
Authorization: Bearer {{token}}


############################################
# 17. UNKNOWN ROUTE
# Expected: 404 Not Found
############################################
### Unknown route
GET http://localhost:3000/unknown-route
Authorization: Bearer {{token}}

